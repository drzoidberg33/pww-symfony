{% extends '::base.html.twig' %}

{% block body %}

    <div class="clear"></div>
    <div class="container">
        <div class='row'>	
            <div class='span12'>
                <div class='wellheader'>
                    <div class='dashboard-wellheader-no-chevron'>
                        <h2><i class="icon-large icon-wrench icon-white"></i> Settings</h2>
                    </div>
                </div>
                {% if message is defined %}
                <div class="alert alert-warning alert-dismissable">
                        {{ message }}      
                    <button type="button" class="close" data-dismiss="alert" aria-hidden="true"><i class="icon icon-remove-circle"></i></button>
                </div>
                {% endif %}
                <div class="row-fluid">
                </div>	
                <div class="row-fluid">
                    <div class='span3'>
                        <ul class="nav nav-list">
                            <li class="active"><a href="#info">General</a></li>
                            <li><a href="#pms">PMS & Database</a></li>
                            <li ><a href="#myplex">Plex Authentication</a></li>
                            <li ><a href="#grouping">Grouping</a></li>	
                        </ul>
                    </div>
                    <div class="span9">
                        {{ form_start(form) }}
                            <fieldset>
                                <div class="wellbg">
                                    <div class="wellheader">
                                        <div class="dashboard-wellheader">
                                            <h3><a id="info">Version Information</a></h3>
                                        </div>
                                    </div>
                                    <div class="settings-general-info">
                                        <ul>
                                            <li>plexWatch/Web Version: <strong>v<span id="current-version">x</span></strong></li>	
                                            <li>&nbsp</li>
                                            <li>plexWatch Version: <strong>v<span id="pw-version"></span></strong></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="wellbg">
                                    <div class="wellheader">
                                        <div class="dashboard-wellheader">
                                            <h3><a id="info">General</a></h3>
                                        </div>
                                    </div>

                                    <!-- Text input-->
                                    <div class="control-group">
                                        {{ form_label(form.dateFormat) }}
                                        {{ form_errors(form.dateFormat) }}
                                        <div class="controls">
                                            {{ form_widget(form.dateFormat) }}
                                            <p class="help-block">The date display format plexWatch/Web should use. <a href="#dateTimeOptionsModal" data-toggle="modal">Date & Time format options</a></p>
                                        </div>
                                    </div>

                                    <!-- Text input-->
                                    <div class="control-group">
                                        {{ form_label(form.timeFormat) }}
                                        {{ form_errors(form.timeFormat) }}
                                        <div class="controls">
                                            {{ form_widget(form.timeFormat) }}
                                            <p class="help-block">The time display format plexWatch/Web should use. <a href="#dateTimeOptionsModal" data-toggle="modal">Date & Time format options</a></p>
                                        </div>
                                    </div>

                                    <!-- Text input-->
                                    <div class="control-group">
                                        {{ form_label(form.updaterPath) }}
                                        {{ form_errors(form.updaterPath) }}
                                        <div class="controls">
                                            {{ form_widget(form.updaterPath) }}
                                            <p class="help-block">Set the server path for online updater (Optional).</p>
                                        </div>
                                    </div>

                                </div>

                                <div id="dateTimeOptionsModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="dateTimeOptionsModal" aria-hidden="true">
                                    <div class="modal-header">	
                                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="icon icon-remove"></i></button>		
                                        <h3 id="myModalLabel">Date & Time Format Options</h3>
                                    </div>
                                    <div class="modal-body">
                                        <div class="span12">
                                            <table>
                                                <tbody>
                                                    <tr><td><h5>Day</h5></td></tr>
                                                    <tr><td align="center"><strong>DD</strong></td><td width="300">Numeric, with leading zeros</td><td>01 to 31</td></tr>
                                                    <tr><td align="center"><strong>D</strong></td><td>Numeric, without leading zeros</td><td>1 to 31</td></tr>
                                                    <tr><td align="center"><strong>Do</strong></td><td>The English suffix for the day of the month</td><td>st, nd or th in the 1st, 2nd or 15th.</td></tr>

                                                    <tr><td><h5>Month</h5></td></tr>
                                                    <tr><td align="center"><strong>MM</strong></td><td>Numeric, with leading zeros</td><td>01 to 31</td></tr>
                                                    <tr><td align="center"><strong>M</strong></td><td>Numeric, without leading zeros</td><td>1 to 31</td></tr>
                                                    <tr><td align="center"><strong>MMMM</strong></td><td>Textual full</td><td>January – December</td></tr>
                                                    <tr><td align="center"><strong>MMM</strong></td><td>Textual three letters</td><td>Jan – Dec</td></tr>

                                                    <tr><td><h5>Year</h5></td></tr>
                                                    <tr><td align="center"><strong>YYYY</strong></td><td>Numeric, 4 digits</td><td>Eg., 1999, 2003</td></tr>
                                                    <tr><td align="center"><strong>YY</strong></td><td>Numeric, 2 digits</td><td>Eg., 99, 03</td></tr>

                                                    <tr><td><h5>Time</h5></td></tr>
                                                    <tr><td align="center"><strong>a</strong></td><td width="300">am/pm Lowercase</td><td>am, pm</td></tr>
                                                    <tr><td align="center"><strong>A</strong></td><td>AM/PM Uppercase</td><td>AM, PM</td></tr>
                                                    <tr><td align="center"><strong>h</strong></td><td>Hour, 12-hour, without leading zeros</td><td>1–12</td></tr>
                                                    <tr><td align="center"><strong>hh</strong></td><td>Hour, 12-hour, with leading zeros</td><td>01–12</td></tr>
                                                    <tr><td align="center"><strong>H</strong></td><td>Hour, 24-hour, without leading zeros</td><td>0-23</td></tr>
                                                    <tr><td align="center"><strong>HH</strong></td><td>Hour, 24-hour, with leading zeros</td><td>00-23</td></tr>
                                                    <tr><td align="center"><strong>mm</strong></td><td>Minutes, with leading zeros</td><td>00-59</td></tr>
                                                    <tr><td align="center"><strong>ss</strong></td><td>Seconds, with leading zeros</td><td>00-59</td></tr>
                                                    <tr><td align="center"><strong>zz</strong></td><td>Timezone abbreviation</td><td>Eg., EST, MDT ...</td></tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                    </div>
                                </div>

                                <div class='wellbg'>
                                    <div class='wellheader'>
                                        <div class='dashboard-wellheader'>
                                            <h3><a id="pms">Plex Media Server & Database Settings</a></h3>
                                        </div>
                                    </div>

                                    <!-- Text input-->
                                    <div class="control-group">
                                        {{ form_label(form.pmsIpAddress) }}
                                        {{ form_errors(form.pmsIpAddress) }}
                                        <div class="controls">
                                            {{ form_widget(form.pmsIpAddress) }}
                                            <p class="help-block">Plex Media Server IP address, hostname or domain name</p>
                                        </div>
                                    </div>

                                    <!-- Text input-->
                                    <div class="control-group">
                                        {{ form_label(form.pmsWebPort) }}
                                        {{ form_errors(form.pmsWebPort) }}
                                        <div class="controls">
                                            {{ form_widget(form.pmsWebPort) }}
                                            <p class="help-block">Plex Media Server's web port</p>
                                        </div>
                                    </div>

                                    <!-- Text input-->
                                    <div class="control-group">
                                        {{ form_label(form.pmsSecureWebPort) }}
                                        {{ form_errors(form.pmsSecureWebPort) }}
                                        <div class="controls">
                                            {{ form_widget(form.pmsSecureWebPort) }}
                                            <p class="help-block">Plex Media Server's secure web port</p>
                                        </div>
                                    </div>

                                    <!-- Multiple Checkboxes (inline) -->
                                    <div class="control-group">
                                        {{ form_label(form.useHttps) }}
                                        <div class="controls">
                                            <label class="checkbox inline" for="https-0">
                                                {{ form_widget(form.useHttps) }}
                                                <p class="help-block">Use Plex Media Server's secure web port</p>
                                            </label>
                                        </div>
                                    </div>

                                    <!-- Text input-->
                                    <div class="control-group">
                                        {{ form_label(form.plexWatchDb) }}
                                        {{ form_errors(form.plexWatchDb) }}
                                        <div class="controls">
                                            {{ form_widget(form.plexWatchDb) }}
                                            <p class="help-block">File location of your plexWatch database.</p>
                                        </div>
                                    </div>

                                </div>	

                                <div class='wellbg'>
                                    <div class='wellheader'>
                                        <div class='dashboard-wellheader'>
                                            <h3><a id="myplex">Plex Authentication</a></h3>
                                        </div>
                                    </div>
                                    <!-- Text input-->
                                    <div class="control-group">
                                        {{ form_label(form.myPlexUsername) }}
                                        {{ form_errors(form.myPlexUsername) }}
                                        <div class="controls">
                                            {{ form_widget(form.myPlexUsername) }}
                                            <p class="help-block">If you would like to access plexWatch/Web on other networks, a <a href="https://plex.tv/users/sign_in">Plex.tv</a> username and password are required.</p>
                                        </div>
                                    </div>

                                    <!-- Text input-->
                                    <div class="control-group">
                                        {{ form_label(form.myPlexPassword) }}
                                        {{ form_errors(form.myPlexPassword) }}
                                        <div class="controls">
                                            {{ form_widget(form.myPlexPassword) }}
                                            <p class="help-block">If you would like to access plexWatch/Web on other networks, a <a href="https://plex.tv/users/sign_in">Plex.tv</a> username and password are required.</p>
                                        </div>
                                    </div>
                                </div>

                                <div class='wellbg'>	

                                    <div class='wellheader'>
                                        <div class='dashboard-wellheader'>
                                            <h3><a id="grouping">Grouping Settings</a></h3>
                                        </div>
                                    </div>

                                    <!-- Multiple Checkboxes (inline) -->
                                    <div class="control-group">
                                        {{ form_label(form.groupingGlobalHistory) }}
                                        <div class="controls">
                                            <label class="checkbox inline" for="globalHistoryGrouping">
                                                {{ form_widget(form.groupingGlobalHistory) }}
                                                <p class="help-block">Enable global history grouping</p>
                                            </label>
                                            {{ form_label(form.groupingUserHistory) }}
                                            <label class="checkbox inline" for="userHistoryGrouping">
                                                {{ form_widget(form.groupingUserHistory) }}
                                                <p class="help-block">Enable user history grouping</p>
                                            </label>
                                            {{ form_label(form.groupingCharts) }}
                                            <label class="checkbox inline" for="chartsGrouping">
                                                {{ form_widget(form.groupingCharts) }}
                                                <p class="help-block">Enable charts grouping</p>
                                            </label>
                                        </div>

                                    </div>
                                </div>

                                <div class="form-actions">
                                    <!-- Button -->
                                    <div class="control-group">
                                        <label class="control-label" for="submit"></label>
                                        <div class="controls">
                                            <div id="friendlyName">
                                                {{ form_widget(form.save, {'attr': {'class': 'btn btn-medium btn-primary'}}) }}
                                                <a href="index.php"><button type="button" class="btn btn-medium btn-cancel">Cancel</button></a>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </fieldset>
                        
                        {{ form_end(form) }}

                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block javascripts %}
    <script>
        function getPlexWatchVersion() {
            $.ajax({
                url: 'api/config/1',
                async: true,
                success: function(data) {
                    $("#pw-version").html(data.version);
                }
            });
        }    
        
        getPlexWatchVersion();
    </script>
    
{% endblock %}